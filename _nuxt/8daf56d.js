(window.webpackJsonp=window.webpackJsonp||[]).push([[265],{1345:function(t,n){const e={render:function(){var t=this;t.$createElement;return t._self._c,t._m(0)},staticRenderFns:[function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"frontmatter-markdown"},[e("h2",{attrs:{id:"三次握手"}},[t._v("三次握手")]),t._v(" "),e("p",[t._v("tcpdump 抓包示例（删除了不必要的字段）：")]),t._v(" "),e("pre",{staticClass:"language-bash"},[e("code",{pre:!0,attrs:{class:"language-bash"}},[e("span",{pre:!0,attrs:{class:"token number"}},[t._v("172.31")]),t._v(".27.207.33944 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".242.180.27017: Flags "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("S"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(", "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("seq")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1310410798")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". length "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".242.180.27017 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("172.31")]),t._v(".27.207.33944: Flags "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("S."),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(", "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("seq")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("3727471852")]),t._v(", ack "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1310410799")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". length "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("172.31")]),t._v(".27.207.33944 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".242.180.27017: Flags "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("."),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(", ack "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("3727471853")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". length "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n")])]),t._v(" "),e("ul",[e("li",[t._v("第一次握手：客户端发送 SYN 包，seq 为 1310410798\n"),e("ul",[e("li",[t._v("客户端：我要从 1310410799（注意此处+1） 开始发送数据")])])]),t._v(" "),e("li",[t._v("第二次握手：服务端发送 SYN+ACK 包，首先通过 ack = seq + 1 确认收到了客户端的 SYN 包，然后发送自己的 SYN 包，seq 为 3727471852\n"),e("ul",[e("li",[t._v("服务器：OK，我会从 1310410799（注意此处+1）开始接收数据，同时我也要从 3727471853（注意此处+1）开始发送数据")])])]),t._v(" "),e("li",[t._v("第三次握手：客户端发送 ACK 包，通过 ack = seq + 1 确认收到了服务端的 SYN+ACK 包\n"),e("ul",[e("li",[t._v("客户端：OK，我会从 3727471853（注意此处+1）开始接收数据")])])])]),t._v(" "),e("h2",{attrs:{id:"数据传输"}},[t._v("数据传输")]),t._v(" "),e("h3",{attrs:{id:"案例-1"}},[t._v("案例 1")]),t._v(" "),e("p",[t._v("tcpdump 抓包示例（删除了不必要的字段）：")]),t._v(" "),e("pre",{staticClass:"language-bash"},[e("code",{pre:!0,attrs:{class:"language-bash"}},[e("span",{pre:!0,attrs:{class:"token number"}},[t._v("172.31")]),t._v(".27.207.33944 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".242.180.27017: Flags "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("P."),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(", "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("seq")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1310410799")]),t._v(":1310411195, ack "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("3727471853")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". length "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("396")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".242.180.27017 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("172.31")]),t._v(".27.207.33944: Flags "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("."),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(", ack "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1310411195")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". length "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".242.180.27017 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("172.31")]),t._v(".27.207.33944: Flags "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("P."),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(", "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("seq")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("3727471853")]),t._v(":3727475566, ack "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1310411195")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". length "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("3713")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("172.31")]),t._v(".27.207.33944 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".242.180.27017: Flags "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("."),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(", ack "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("3727475566")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". length "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("172.31")]),t._v(".27.207.33944 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".242.180.27017: Flags "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("P."),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(", "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("seq")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1310411195")]),t._v(":1310411333, ack "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("3727475566")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". length "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("138")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".242.180.27017 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("172.31")]),t._v(".27.207.33944: Flags "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("P."),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(", "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("seq")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("3727475566")]),t._v(":3727475840, ack "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1310411333")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". length "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("274")]),t._v("\n")])]),t._v(" "),e("ul",[e("li",[t._v("第一个包：根据三次握手协商的客户端 seq，客户端发送 1310410799-1310411195 的数据（不包括 1310411195，共 396 字节），并基于三次握手中服务器的 seq 发送 ack = seq + 1")]),t._v(" "),e("li",[t._v("第二个包：服务器收到客户端的数据，发送 ack = seq + 1（因为客户端的 seq 不包括 1310411195，所以服务器返回的 ack = seq + 1，是 1310411195）")]),t._v(" "),e("li",[t._v("第三个包：根据三次握手协商的服务端 seq，服务器发送 3727471853-3727475566 的数据（不包括 3727475566，共 3713 字节），并再次发送 ack = 1310411195，因为客户端 seq 没有变化")]),t._v(" "),e("li",[t._v("第四个包：客户端收到服务端的数据，发送 ack = seq + 1")]),t._v(" "),e("li",[t._v("后面的略")])]),t._v(" "),e("p",[t._v("以上是典型的【客户端 SEQ -> 服务器 ACK -> 服务器 SEQ -> 客户端 ACK】的流程，相当于客户端和服务器每次只说一句话，交替说")]),t._v(" "),e("h3",{attrs:{id:"案例-2"}},[t._v("案例 2")]),t._v(" "),e("pre",{staticClass:"language-bash"},[e("code",{pre:!0,attrs:{class:"language-bash"}},[e("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".242.180.27017 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("172.31")]),t._v(".27.207.33954: Flags "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("P."),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(", "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("seq")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("3168350326")]),t._v(":3168353222, ack "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("664805962")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". length "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2896")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("172.31")]),t._v(".27.207.33954 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".242.180.27017: Flags "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("."),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(", ack "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("3168353222")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". length "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".242.180.27017 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("172.31")]),t._v(".27.207.33954: Flags "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("P."),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(", "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("seq")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("3168353222")]),t._v(":3168354039, ack "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("664805962")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". length "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("817")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("172.31")]),t._v(".27.207.33954 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".242.180.27017: Flags "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("."),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(", ack "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("3168354039")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". length "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n")])]),t._v(" "),e("p",[t._v("在此案例里面，服务器连着说了两句话，客户端只负责 ACK，没有发送数据，所以出现了第一个包和第三个包的 ack 相同的情况（因为客户端没有发数据，所以客户端 seq 不变，所以服务端的 ack 也不变）")]),t._v(" "),e("h3",{attrs:{id:"案例-3"}},[t._v("案例 3")]),t._v(" "),e("pre",{staticClass:"language-bash"},[e("code",{pre:!0,attrs:{class:"language-bash"}},[e("span",{pre:!0,attrs:{class:"token number"}},[t._v("172.31")]),t._v(".27.207.33944 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".242.180.27017: Flags "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("P."),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(", "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("seq")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1310411195")]),t._v(":1310411333, ack "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("3727475566")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". length "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("138")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".242.180.27017 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("172.31")]),t._v(".27.207.33944: Flags "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("P."),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(", "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("seq")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("3727475566")]),t._v(":3727475840, ack "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1310411333")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". length "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("274")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("172.31")]),t._v(".27.207.33944 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".242.180.27017: Flags "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("P."),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(", "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("seq")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1310411333")]),t._v(":1310411708, ack "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("3727475840")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". length "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("375")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".242.180.27017 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("172.31")]),t._v(".27.207.33944: Flags "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("P."),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(", "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("seq")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("3727475840")]),t._v(":3727476944, ack "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1310411708")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". length "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1104")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("172.31")]),t._v(".27.207.33944 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".242.180.27017: Flags "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("."),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(", ack "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("3727476944")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". length "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n")])]),t._v(" "),e("p",[t._v("在此案例中，服务器和客户端进行密集地通信，每个包都既包含数据又包含 ack")]),t._v(" "),e("ul",[e("li",[t._v("第一个包：客户端发送 1310411195-1310411333 的数据（不包括 1310411333，共 138 字节），并发送 ack = 3727475566")]),t._v(" "),e("li",[t._v("第二个包：服务器发送 3727475566-3727475840 的数据（不包括 3727475840，共 274 字节），并发送 ack = 1310411333，确认第一个包已收到")])]),t._v(" "),e("h2",{attrs:{id:"四次挥手"}},[t._v("四次挥手")]),t._v(" "),e("pre",{staticClass:"language-bash"},[e("code",{pre:!0,attrs:{class:"language-bash"}},[e("span",{pre:!0,attrs:{class:"token number"}},[t._v("172.31")]),t._v(".27.207.33944 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".242.180.27017: Flags "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("F."),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(", "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("seq")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1310411708")]),t._v(", ack "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("3727476944")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". length "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".242.180.27017 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("172.31")]),t._v(".27.207.33944: Flags "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("F."),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(", "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("seq")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("3727476944")]),t._v(", ack "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1310411709")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". length "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("172.31")]),t._v(".27.207.33944 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".242.180.27017: Flags "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("."),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(", ack "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("3727476945")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". length "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n")])]),t._v(" "),e("p",[t._v("虽说是四次握手，但是第 2/3 次握手是同时进行的，所以看起来像是三次握手")]),t._v(" "),e("h2",{attrs:{id:"总结"}},[t._v("总结")]),t._v(" "),e("ul",[e("li",[t._v("客户端和服务器各维护自己的 seq")]),t._v(" "),e("li",[t._v("客户端和服务器各维护对方的 ack")]),t._v(" "),e("li",[t._v("握手/挥手时，ack = seq + 1")]),t._v(" "),e("li",[t._v("传输数据时，ack = seq + data length")]),t._v(" "),e("li",[t._v("如何保证可靠传输？验证 seq/ack 满足以上规则即可，如果不合法，则丢弃")]),t._v(" "),e("li",[t._v("如果双方同时发包？会导致 ack/seq 不满足以上规则，从而丢包，避免冲突的出现")])])])}]};t.exports={attributes:{title:"理解TCP协议中SEQ与ACK的计算逻辑",tags:["计算机网络"]},vue:{render:e.render,staticRenderFns:e.staticRenderFns,component:{data:function(){return{templateRender:null}},render:function(t){return this.templateRender?this.templateRender():t("div","Rendering")},created:function(){this.templateRender=e.render,this.$options.staticRenderFns=e.staticRenderFns}}}}}}]);