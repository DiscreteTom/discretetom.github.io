(window.webpackJsonp=window.webpackJsonp||[]).push([[35,857,858,859,860,861,862,863,864,865],{1041:function(t,e,n){t.exports=n.p+"img/7bf6ed6.png"},1042:function(t,e,n){t.exports=n.p+"img/b0e2a47.png"},1043:function(t,e,n){t.exports=n.p+"img/6ea6933.png"},1044:function(t,e,n){t.exports=n.p+"img/0b809cd.png"},1045:function(t,e,n){t.exports=n.p+"img/cbcd960.png"},1046:function(t,e,n){t.exports=n.p+"img/929e520.png"},1047:function(t,e,n){t.exports=n.p+"img/bafbf83.png"},1048:function(t,e,n){t.exports=n.p+"img/0848172.png"},1049:function(t,e,n){t.exports=n.p+"img/7dcadbf.png"},1201:function(t,e,n){const r={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"frontmatter-markdown"},[n("h2",{attrs:{id:"新建控件"}},[t._v("新建控件")]),t._v(" "),n("p",[t._v("添加新文件 - C++ Class")]),t._v(" "),t._m(0),t._v(" "),t._m(1),t._v(" "),n("p",[t._v("为了方便展示效果，此处以QLabel作为父类")]),t._v(" "),t._m(2),t._v(" "),t._m(3),t._v(" "),n("ul",[n("li",[t._v("在mylabel.h文件中添加父类的头文件"),n("QLabel")],1),t._v(" "),n("li",[t._v("添加Qt的Object标识 Q_OBJECT")]),t._v(" "),n("li",[t._v("构造函数参数增加父指针")])]),t._v(" "),n("p",[t._v("效果如下")]),t._v(" "),t._m(4),t._v(" "),n("p",[t._v("因为在本来没有Q_OBJECT标识的类里面添加了Q_OBJECT标识，所以要执行一次qmake，否则会报错 “qt undefined reference to vtable for xxx”")]),t._v(" "),t._m(5),t._v(" "),n("p",[t._v("在MainWindow中包含此控件")]),t._v(" "),t._m(6),t._v(" "),t._m(7),t._v(" "),n("p",[t._v("运行以测试效果")]),t._v(" "),t._m(8),t._v(" "),n("h2",{attrs:{id:"获取焦点"}},[t._v("获取焦点")]),t._v(" "),n("p",[t._v("一个控件在获取焦点之后才会对键盘操作进行响应")]),t._v(" "),n("p",[t._v("在MyLabel的构造函数中添加如下代码")]),t._v(" "),t._m(9),t._v(" "),n("p",[t._v("此代码的作用为设置此控件的焦点获取策略为鼠标点击")]),t._v(" "),n("p",[t._v("如果想要测试效果 可以在MyLabel类中添加如下protected方法")]),t._v(" "),t._m(10),t._v(" "),n("p",[t._v("然后在cpp文件内添加")]),t._v(" "),t._m(11),t._v(" "),n("p",[t._v("运行程序 点击控件后控件的内容会发生改变")]),t._v(" "),n("h2",{attrs:{id:"支持英文输入"}},[t._v("支持英文输入")]),t._v(" "),n("p",[t._v("在MyLabel中添加如下protected方法")]),t._v(" "),t._m(12),t._v(" "),n("p",[t._v("此方法将响应键盘的按键操作")]),t._v(" "),n("p",[t._v("在cpp文件中添加函数定义")]),t._v(" "),t._m(13),t._v(" "),n("p",[t._v("这里的代码功能比较简单 只实现了简单的输入操作和删除最后一个字符的操作 读者可以根据自己的需要自行编辑")]),t._v(" "),n("p",[t._v("如果此时尝试输入中文 会发现不能简单地使用输入法中英文切换键(如shift)切换中英文 而且输入汉字也无响应")]),t._v(" "),n("h2",{attrs:{id:"支持中文输入"}},[t._v("支持中文输入")]),t._v(" "),n("p",[t._v("输入法在中文状态下是无法响应KeyPressEvent的")]),t._v(" "),n("p",[t._v("首先在MyLabel的构造函数中添加如下代码")]),t._v(" "),t._m(14),t._v(" "),n("p",[t._v("Qt是这么介绍WA_InputMethodEnabled的:")]),t._v(" "),t._m(15),t._v(" "),n("p",[t._v("此时再次尝试输入中文 发现已经可以使用输入法自带中英文切换键切换中英文 但是仍然无法获得输入的字符")]),t._v(" "),n("p",[t._v("因为不是使用KeyPressEvent来获取事件 我们需要一个新的获取事件的方法")]),t._v(" "),n("p",[t._v("在MyLabel类中添加如下protected方法")]),t._v(" "),t._m(16),t._v(" "),n("p",[t._v("然后在cpp文件添加函数定义")]),t._v(" "),t._m(17),t._v(" "),n("p",[t._v("解释: 输入法返回的事件被inputMethodEvent响应 通过commitString方法获得此事件中包含的中文字符串 然后接到原字符串的末尾")]),t._v(" "),n("p",[t._v("至此 实现中文输入")]),t._v(" "),n("h2",{attrs:{id:"其他"}},[t._v("其他")]),t._v(" "),n("p",[t._v("按照网上的说法 除了")]),t._v(" "),t._m(18),t._v(" "),n("p",[t._v("之外 还要有一条语句")]),t._v(" "),t._m(19),t._v(" "),n("p",[t._v("但是我看了一下文档似乎并不需要 注释掉这条语句之后程序也没有出错 如果未来程序遇到了问题也许可以尝试加上这条语句解决:)")]),t._v(" "),n("p",[t._v("参考:")]),t._v(" "),t._m(20)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:n(1041),alt:"6-1"}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:n(1042),alt:"6-2"}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("Class name 设置为 MyLabel")]),this._v(" "),e("li",[this._v("Base Class 选择 Custom 并填写 QLabel")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:n(1043),alt:"6-3"}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:n(1044),alt:"6-4"}}),this._v(" "),e("img",{attrs:{src:n(1045),alt:"6-5"}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:n(1046),alt:"6-6"}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:n(1047),alt:"6-7"}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:n(1048),alt:"6-8"}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:n(1049),alt:"6-9"}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("pre",{staticClass:"language-c++"},[e("code",{pre:!0,attrs:{class:"language-c++"}},[this._v("setFocusPolicy(Qt::ClickFocus);\n")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("pre",{staticClass:"language-c++"},[e("code",{pre:!0,attrs:{class:"language-c++"}},[this._v("//需要#include <QFocusEvent>\nvoid focusInEvent(QFocusEvent * ev);//获取焦点时的操作\nvoid focusOutEvent(QFocusEvent * ev);//失去焦点时的操作\n")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("pre",{staticClass:"language-c++"},[e("code",{pre:!0,attrs:{class:"language-c++"}},[this._v('void MyLabel::focusInEvent(QFocusEvent * ev)\n{\n\tsetText(tr("focusIn"));\n}\n\nvoid MyLabel::focusOutEvent(QFocusEvent * ev)\n{\n\tsetText(tr("FocusOut"));\n}\n')])])},function(){var t=this.$createElement,e=this._self._c||t;return e("pre",{staticClass:"language-c++"},[e("code",{pre:!0,attrs:{class:"language-c++"}},[this._v("//需要#include <QKeyEvent>\nvoid keyPressEvent(QKeyEvent * ev);\n")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("pre",{staticClass:"language-c++"},[e("code",{pre:!0,attrs:{class:"language-c++"}},[this._v("void MyLabel::keyPressEvent(QKeyEvent * ev)\n{\n\tQString str = text();//获取原字符串\n\n\tif (ev->key() == Qt::Key_Backspace){\n\t\t//如果按键是Backspace\n\t\tstr.chop(1);//删除原字符串最后一个字符\n\t\tsetText(str);//显示新字符串\n\t} else {\n\t\t//不是Backspace\n\t\tstr += ev->text();//在原字符串后添加新输入的字符\n\t\tsetText(str);//显示新字符串\n\t}\n}\n")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("pre",{staticClass:"language-c++"},[e("code",{pre:!0,attrs:{class:"language-c++"}},[this._v("setAttribute(Qt::WA_InputMethodEnabled, true);\n")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("blockquote",[e("p",[this._v("Enables input methods for Asian languages. Must be set when creating custom text editing widgets.")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("pre",{staticClass:"language-c++"},[e("code",{pre:!0,attrs:{class:"language-c++"}},[this._v("//需要#include <QInputMethodEvent>\nvoid inputMethodEvent(QInputMethodEvent * ev);\n")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("pre",{staticClass:"language-c++"},[e("code",{pre:!0,attrs:{class:"language-c++"}},[this._v("void MyLabel::inputMethodEvent(QInputMethodEvent * ev)\n{\n\tQString str = text();//获取原字符串\n\n\tstr += ev->commitString();//原字符串后接上输入的中文字符串\n\tsetText(str);//显示新字符串\n}\n")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("pre",{staticClass:"language-c++"},[e("code",{pre:!0,attrs:{class:"language-c++"}},[this._v("setAttribute(Qt::WA_InputMethodEnabled, true);\n")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("pre",{staticClass:"language-c++"},[e("code",{pre:!0,attrs:{class:"language-c++"}},[this._v("setAttribute(Qt::WA_KeyCompression, true);\n")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[e("a",{attrs:{href:"https://blog.csdn.net/u013686019/article/details/38712563"}},[this._v(" [Qt解错篇]报错：error: undefined reference to vtable for ClassName")])]),this._v(" "),e("li",[e("a",{attrs:{href:"https://jingyan.baidu.com/article/d621e8da0c25032865913f87.html"}},[this._v("Qt中焦点策略FocusPolicy的使用")])]),this._v(" "),e("li",[e("a",{attrs:{href:"https://bbs.csdn.net/topics/390154489"}},[this._v("Qt有接收输入法字符串的事件么，keyPressEvent行不行？")])]),this._v(" "),e("li",[e("a",{attrs:{href:"https://blog.csdn.net/dongpanshan/article/details/78251556"}},[this._v("QT中文输入法状态下获取键盘输入事件")])])])}]};t.exports={attributes:{title:"Qt-自定义Object如何支持中英文键盘输入",date:"2018-03-28T00:00:00.000Z",tags:["qt"]},vue:{render:r.render,staticRenderFns:r.staticRenderFns,component:{data:function(){return{templateRender:null}},render:function(t){return this.templateRender?this.templateRender():t("div","Rendering")},created:function(){this.templateRender=r.render,this.$options.staticRenderFns=r.staticRenderFns}}}}}}]);